/*!CK:2773594733!*//*1416802021,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["TFKT+"]); }

__d("FacebarTypeaheadV2",["CSS","csx","cx","DOM","Event","Parent"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m={init:function(n){this._view=n.getView();this._root=l.byClass(n.getElement(),"_585-");this._button=j.find(this._root,"._4w98");this._core=n.getCore();k.listen(this._button,'mousedown',this.buttonDown.bind(this));k.listen(this._button,'mouseup',this.buttonUp.bind(this));this._core.subscribe('open',this.showButton.bind(this));this._core.subscribe('close',this.hideButton.bind(this));},showButton:function(){g.addClass(this._button,"_4w97");},hideButton:function(){if(g.hasClass(this._button,"_4w97"))g.removeClass(this._button,"_4w97");},buttonDown:function(event){event.preventDefault();},buttonUp:function(){if(!this._core.isFocused){this._core.focusInput();}else this._core.submitQuery();}};e.exports=m;},null);
__d("FacebarTypeaheadMagKeywordSearch",["csx","DOM","Event","FacebarGlobalOptions","FacebarKeywordSearchUtils","FacebarStructuredText","FacebarURI","FacebarResultStoreUtils","SubscriptionsHandler","URI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(r){"use strict";this._typeahead=r;this._core=r.getCore();this._data=r.getData();this._view=this._core.view;this._input=this._core.input;this._handler=new o();}q.prototype.enable=function(){"use strict";var r=h.find(document,"div._4f7n ._585_");this._handler.addSubscriptions(i.listen(r,'click',this._runQuery.bind(this)));};q.prototype.disable=function(){"use strict";this._handler.release();};q.prototype._focusInput=function(){"use strict";this._input.input.focus();};q.prototype._runQuery=function(){"use strict";if(this._view.index<0){this._focusInput();return;}var r=this._input.getValue(),s=this._data.getRawStructure(r);if(!s||s.is_empty){this._focusInput();return;}var t;if(!s.raw_text){t=n.getRawTextFromStructured(r.toArray());}else t=s.raw_text;if(j.keywordSearchEnabled){var u=k.makeFacebarEntry(t);return this._core.executeQuery(u);}var v=p(this._view.seeMoreSerpEndpoint).addQueryData('q',t).addQueryData('sid',this._core.getSessionID());v=m.getQualifiedURI(v);return this._core.executeQuery({uid:'see_more_serp',node:this._moreBar,structure:new l(),search:true,uri:v,type:'see_more_serp',text:t,selected:true,semantic:'seemore('+t+')'});};e.exports=q;},null);